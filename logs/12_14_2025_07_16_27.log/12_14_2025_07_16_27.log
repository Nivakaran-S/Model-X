[ 2025-12-14 07:16:27,215 ] 45 root - INFO - 
============================================================
[ 2025-12-14 07:16:27,216 ] 46 root - INFO - ANOMALY DETECTION TRAINING PIPELINE
[ 2025-12-14 07:16:27,218 ] 47 root - INFO - Started at: 2025-12-14 07:16:27
[ 2025-12-14 07:16:27,219 ] 48 root - INFO - Models to train: ['dbscan', 'kmeans', 'hdbscan', 'isolation_forest', 'lof']
[ 2025-12-14 07:16:27,219 ] 49 root - INFO - MLflow experiment: anomaly_detection_feeds
[ 2025-12-14 07:16:27,220 ] 50 root - INFO - ============================================================

[ 2025-12-14 07:16:27,221 ] 37 data_ingestion - INFO - [DataIngestion] Initialized
[ 2025-12-14 07:16:27,222 ] 38 data_ingestion - INFO -   SQLite: C:\Users\LENOVO\Desktop\ModelX-Ultimate\data\feeds\feed_cache.db
[ 2025-12-14 07:16:27,222 ] 39 data_ingestion - INFO -   CSV Dir: C:\Users\LENOVO\Desktop\ModelX-Ultimate\datasets\political_feeds
[ 2025-12-14 07:16:27,222 ] 40 data_ingestion - INFO -   Output: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion
[ 2025-12-14 07:16:27,223 ] 55 root - INFO - Starting data ingestion...
[ 2025-12-14 07:16:27,223 ] 193 data_ingestion - INFO - [DataIngestion] Starting data ingestion...
[ 2025-12-14 07:16:27,224 ] 52 data_ingestion - WARNING - [DataIngestion] SQLite DB not found: C:\Users\LENOVO\Desktop\ModelX-Ultimate\data\feeds\feed_cache.db
[ 2025-12-14 07:16:27,246 ] 107 data_ingestion - INFO - [DataIngestion] Loaded 1 records from economic_feeds_202512.csv
[ 2025-12-14 07:16:27,267 ] 107 data_ingestion - INFO - [DataIngestion] Loaded 92 records from intelligence_feeds_202512.csv
[ 2025-12-14 07:16:27,427 ] 107 data_ingestion - INFO - [DataIngestion] Loaded 86 records from political_feeds_202512.csv
[ 2025-12-14 07:16:27,439 ] 107 data_ingestion - INFO - [DataIngestion] Loaded 71 records from social_feeds_202512.csv
[ 2025-12-14 07:16:27,550 ] 107 data_ingestion - INFO - [DataIngestion] Loaded 15 records from weather_feeds_202512.csv
[ 2025-12-14 07:16:27,562 ] 115 data_ingestion - INFO - [DataIngestion] Total 265 records from 5 CSV files
[ 2025-12-14 07:16:27,568 ] 143 data_ingestion - INFO - [DataIngestion] Deduplicated: removed 129 duplicates
[ 2025-12-14 07:16:27,572 ] 182 data_ingestion - INFO - [DataIngestion] Filtered: removed 15 short texts
[ 2025-12-14 07:16:27,691 ] 235 data_ingestion - INFO - [DataIngestion] Saved 121 records to C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion\ingested_data_20251214_071627.parquet
[ 2025-12-14 07:16:27,691 ] 249 data_ingestion - INFO - [DataIngestion] \u2713 Complete: 121 records
[ 2025-12-14 07:16:27,692 ] 57 root - INFO - \u2713 Data ingestion completed
[ 2025-12-14 07:16:27,709 ] 39 data_validation - INFO - [DataValidation] Initialized with schema: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\data_schema\schema.yaml
[ 2025-12-14 07:16:27,710 ] 62 root - INFO - Starting data validation...
[ 2025-12-14 07:16:27,710 ] 195 data_validation - INFO - [DataValidation] Validating: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion\ingested_data_20251214_071627.parquet
[ 2025-12-14 07:16:27,838 ] 206 data_validation - INFO - [DataValidation] Loaded 121 records
[ 2025-12-14 07:16:27,849 ] 227 data_validation - WARNING - [DataValidation] \u26a0 Found 2 validation issues
[ 2025-12-14 07:16:27,849 ] 229 data_validation - WARNING -   - Column 'timestamp' has 90 null values
[ 2025-12-14 07:16:27,849 ] 229 data_validation - WARNING -   - Column 'platform' has 10 values not in allowed list
[ 2025-12-14 07:16:27,892 ] 260 data_validation - INFO - [DataValidation] \u2713 Complete: 31/121 valid records
[ 2025-12-14 07:16:27,892 ] 66 root - INFO - \u2713 Data validation completed
[ 2025-12-14 07:16:27,895 ] 73 vectorizer - INFO - [Vectorizer] Using device: cpu
[ 2025-12-14 07:16:31,986 ] 66 data_transformation - WARNING - [DataTransformation] Vectorization API not available: HTTPConnectionPool(host='localhost', port=8001): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002022A060250>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
[ 2025-12-14 07:16:31,987 ] 67 data_transformation - INFO - [DataTransformation] Using local vectorization (no LLM insights)
[ 2025-12-14 07:16:31,987 ] 69 data_transformation - INFO - [DataTransformation] Initialized
[ 2025-12-14 07:16:31,987 ] 70 data_transformation - INFO -   Models cache: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\models_cache
[ 2025-12-14 07:16:31,987 ] 71 data_transformation - INFO -   Vectorization API: disabled (using local)
[ 2025-12-14 07:16:31,987 ] 71 root - INFO - Starting data transformation...
[ 2025-12-14 07:16:31,988 ] 346 data_transformation - INFO - [DataTransformation] Starting transformation: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_validation\validated_data_20251214_071627.parquet
[ 2025-12-14 07:16:32,030 ] 351 data_transformation - INFO - [DataTransformation] Loaded 121 records
[ 2025-12-14 07:16:32,031 ] 158 data_transformation - INFO - [DataTransformation] Detecting languages...
[ 2025-12-14 07:16:32,467 ] 78 language_detector - INFO - [LanguageDetector] Loaded FastText model from C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\models_cache\lid.176.bin
[ 2025-12-14 07:16:32,473 ] 93 language_detector - INFO - [LanguageDetector] Initialized Lingua detector
[ 2025-12-14 07:16:33,892 ] 173 data_transformation - INFO - [DataTransformation] Language distribution:
[ 2025-12-14 07:16:33,892 ] 175 data_transformation - INFO -   english: 103 (85.1%)
[ 2025-12-14 07:16:33,892 ] 175 data_transformation - INFO -   tamil: 14 (11.6%)
[ 2025-12-14 07:16:33,892 ] 175 data_transformation - INFO -   sinhala: 4 (3.3%)
[ 2025-12-14 07:16:33,892 ] 189 data_transformation - INFO - [DataTransformation] Extracting temporal features...
[ 2025-12-14 07:16:33,909 ] 223 data_transformation - INFO - [DataTransformation] Extracting engagement features...
[ 2025-12-14 07:16:33,914 ] 261 data_transformation - INFO - [DataTransformation] Extracting text features...
[ 2025-12-14 07:16:33,943 ] 278 data_transformation - INFO - [DataTransformation] Vectorizing texts with BERT models...
[ 2025-12-14 07:16:33,946 ] 94 vectorizer - INFO - [Vectorizer] Loading model: distilbert-base-uncased
[ 2025-12-14 07:16:39,906 ] 108 vectorizer - INFO - [Vectorizer] \u2713 Loaded distilbert-base-uncased (english)
[ 2025-12-14 07:16:58,542 ] 94 vectorizer - INFO - [Vectorizer] Loading model: l3cube-pune/tamil-bert
[ 2025-12-14 07:17:04,294 ] 108 vectorizer - INFO - [Vectorizer] \u2713 Loaded l3cube-pune/tamil-bert (tamil)
[ 2025-12-14 07:17:10,179 ] 94 vectorizer - INFO - [Vectorizer] Loading model: keshan/SinhalaBERTo
[ 2025-12-14 07:17:18,106 ] 108 vectorizer - INFO - [Vectorizer] \u2713 Loaded keshan/SinhalaBERTo (sinhala)
[ 2025-12-14 07:17:43,988 ] 306 data_transformation - INFO - [DataTransformation] Building feature matrix...
[ 2025-12-14 07:17:43,992 ] 330 data_transformation - INFO - [DataTransformation] Feature matrix shape: (121, 776)
[ 2025-12-14 07:17:44,036 ] 415 data_transformation - INFO - [DataTransformation] Saved language labels to languages_20251214_071743.npy
[ 2025-12-14 07:17:44,041 ] 459 data_transformation - INFO - [DataTransformation] \u2713 Complete: (121, 776)
[ 2025-12-14 07:17:44,042 ] 75 root - INFO - \u2713 Data transformation completed
[ 2025-12-14 07:17:47,406 ] 103 model_trainer - INFO - [ModelTrainer] MLflow configured: https://dagshub.com/sliitguy/Model-X.mlflow
[ 2025-12-14 07:17:47,406 ] 77 model_trainer - INFO - [ModelTrainer] Initialized
[ 2025-12-14 07:17:47,406 ] 78 model_trainer - INFO -   Models to train: ['dbscan', 'kmeans', 'hdbscan', 'isolation_forest', 'lof']
[ 2025-12-14 07:17:47,406 ] 79 model_trainer - INFO -   Optuna trials: 50
[ 2025-12-14 07:17:47,406 ] 80 root - INFO - Starting model training...
[ 2025-12-14 07:17:47,407 ] 371 model_trainer - INFO - [ModelTrainer] Starting training: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_transformation\features_20251214_071743.npy
[ 2025-12-14 07:17:47,436 ] 376 model_trainer - INFO - [ModelTrainer] Loaded features: (121, 776)
[ 2025-12-14 07:17:52,041 ] 400 model_trainer - INFO - [ModelTrainer] Training dbscan...
[ 2025-12-14 07:17:56,931 ] 331 model_trainer - INFO - [ModelTrainer] dbscan best params: {'eps': 0.11211353826080822, 'min_samples': 4}
[ 2025-12-14 07:17:56,931 ] 332 model_trainer - INFO - [ModelTrainer] dbscan best score: 0.9820
[ 2025-12-14 07:18:43,535 ] 437 model_trainer - INFO - [ModelTrainer] \u2713 dbscan complete
[ 2025-12-14 07:18:43,535 ] 400 model_trainer - INFO - [ModelTrainer] Training kmeans...
[ 2025-12-14 07:18:51,110 ] 331 model_trainer - INFO - [ModelTrainer] kmeans best params: {'n_clusters': 2, 'n_init': 20}
[ 2025-12-14 07:18:51,110 ] 332 model_trainer - INFO - [ModelTrainer] kmeans best score: 0.4239
[ 2025-12-14 07:21:38,203 ] 868 urllib3.connectionpool - WARNING - Retrying (Retry(total=6, connect=7, read=6, redirect=7, status=7)) after connection broken by 'ReadTimeoutError("HTTPSConnectionPool(host='dagshub.com', port=443): Read timed out. (read timeout=120)")': /sliitguy/Model-X.mlflow/api/2.0/mlflow-artifacts/artifacts/f5e3c0ae25ab4dc9bba2114c67145a2c/models/m-69f8ffb917e64a45a72b0c863f6f6da4/artifacts/conda.yaml
[ 2025-12-14 07:22:27,020 ] 868 urllib3.connectionpool - WARNING - Retrying (Retry(total=5, connect=7, read=6, redirect=7, status=7)) after connection broken by 'SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)'))': /sliitguy/Model-X.mlflow/api/2.0/mlflow-artifacts/artifacts/f5e3c0ae25ab4dc9bba2114c67145a2c/models/m-69f8ffb917e64a45a72b0c863f6f6da4/artifacts/conda.yaml
[ 2025-12-14 07:22:49,520 ] 868 urllib3.connectionpool - WARNING - Retrying (Retry(total=4, connect=7, read=6, redirect=7, status=7)) after connection broken by 'SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)'))': /sliitguy/Model-X.mlflow/api/2.0/mlflow-artifacts/artifacts/f5e3c0ae25ab4dc9bba2114c67145a2c/models/m-69f8ffb917e64a45a72b0c863f6f6da4/artifacts/conda.yaml
[ 2025-12-14 07:23:15,362 ] 868 urllib3.connectionpool - WARNING - Retrying (Retry(total=3, connect=7, read=6, redirect=7, status=7)) after connection broken by 'SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)'))': /sliitguy/Model-X.mlflow/api/2.0/mlflow-artifacts/artifacts/f5e3c0ae25ab4dc9bba2114c67145a2c/models/m-69f8ffb917e64a45a72b0c863f6f6da4/artifacts/conda.yaml
[ 2025-12-14 07:23:54,372 ] 868 urllib3.connectionpool - WARNING - Retrying (Retry(total=2, connect=7, read=6, redirect=7, status=7)) after connection broken by 'SSLError(SSLEOFError(8, '[SSL: UNEXPECTED_EOF_WHILE_READING] EOF occurred in violation of protocol (_ssl.c:1016)'))': /sliitguy/Model-X.mlflow/api/2.0/mlflow-artifacts/artifacts/f5e3c0ae25ab4dc9bba2114c67145a2c/models/m-69f8ffb917e64a45a72b0c863f6f6da4/artifacts/conda.yaml
[ 2025-12-14 07:24:05,514 ] 437 model_trainer - INFO - [ModelTrainer] \u2713 kmeans complete
[ 2025-12-14 07:24:05,514 ] 400 model_trainer - INFO - [ModelTrainer] Training hdbscan...
