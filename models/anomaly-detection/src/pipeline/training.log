2025-12-08 16:36:01,292 - language_detector - WARNING - FastText not available. Install with: pip install fasttext
2025-12-08 16:36:01,294 - language_detector - WARNING - Lingua not available. Install with: pip install lingua-language-detector
2025-12-08 16:37:05,084 - tensorflow - WARNING - From C:\Users\LENOVO\AppData\Local\Programs\Python\Python313\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-12-08 16:37:07,956 - model_trainer - WARNING - Optuna not available. Install with: pip install optuna
2025-12-08 16:37:11,240 - model_trainer - WARNING - HDBSCAN not available. Install with: pip install hdbscan
2025-12-08 16:37:11,246 - main - INFO - ============================================================
2025-12-08 16:37:11,246 - main - INFO - ANOMALY DETECTION PIPELINE
2025-12-08 16:37:11,247 - main - INFO - ============================================================
2025-12-08 16:37:11,260 - training_pipeline - INFO - [TrainingPipeline] Initialized (run_id: 20251208_163711)
2025-12-08 16:37:11,260 - training_pipeline - INFO - ============================================================
2025-12-08 16:37:11,261 - training_pipeline - INFO - [TrainingPipeline] STARTING TRAINING PIPELINE
2025-12-08 16:37:11,261 - training_pipeline - INFO - ============================================================
2025-12-08 16:37:11,261 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:11,261 - training_pipeline - INFO - [TrainingPipeline] STEP 1: Data Ingestion
2025-12-08 16:37:11,262 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:11,262 - data_ingestion - INFO - [DataIngestion] Initialized
2025-12-08 16:37:11,263 - data_ingestion - INFO -   SQLite: C:\Users\LENOVO\Desktop\ModelX-Ultimate\data\feeds\feed_cache.db
2025-12-08 16:37:11,263 - data_ingestion - INFO -   CSV Dir: C:\Users\LENOVO\Desktop\ModelX-Ultimate\datasets\political_feeds
2025-12-08 16:37:11,263 - data_ingestion - INFO -   Output: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion
2025-12-08 16:37:11,263 - data_ingestion - INFO - [DataIngestion] Starting data ingestion...
2025-12-08 16:37:11,263 - data_ingestion - WARNING - [DataIngestion] SQLite DB not found: C:\Users\LENOVO\Desktop\ModelX-Ultimate\data\feeds\feed_cache.db
2025-12-08 16:37:11,351 - data_ingestion - INFO - [DataIngestion] Loaded 358 records from economic_feeds_202512.csv
2025-12-08 16:37:11,419 - data_ingestion - INFO - [DataIngestion] Loaded 310 records from intelligence_feeds_202512.csv
2025-12-08 16:37:11,491 - data_ingestion - INFO - [DataIngestion] Loaded 972 records from political_feeds_202512.csv
2025-12-08 16:37:11,608 - data_ingestion - INFO - [DataIngestion] Loaded 500 records from social_feeds_202512.csv
2025-12-08 16:37:11,673 - data_ingestion - INFO - [DataIngestion] Loaded 578 records from weather_feeds_202512.csv
2025-12-08 16:37:11,705 - data_ingestion - INFO - [DataIngestion] Total 2718 records from 5 CSV files
2025-12-08 16:37:11,716 - data_ingestion - INFO - [DataIngestion] Deduplicated: removed 2519 duplicates
2025-12-08 16:37:11,720 - data_ingestion - INFO - [DataIngestion] Filtered: removed 2 short texts
2025-12-08 16:37:12,149 - data_ingestion - INFO - [DataIngestion] Saved 197 records to C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion\ingested_data_20251208_163711.parquet
2025-12-08 16:37:12,229 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:12,229 - training_pipeline - INFO - [TrainingPipeline] STEP 2: Data Validation
2025-12-08 16:37:12,229 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:12,240 - data_validation - INFO - [DataValidation] Initialized with schema: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\data_schema\schema.yaml
2025-12-08 16:37:12,240 - data_validation - INFO - [DataValidation] Validating: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_ingestion\ingested_data_20251208_163711.parquet
2025-12-08 16:37:13,378 - data_validation - INFO - [DataValidation] Loaded 197 records
2025-12-08 16:37:13,412 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:13,413 - training_pipeline - INFO - [TrainingPipeline] STEP 3: Data Transformation
2025-12-08 16:37:13,413 - training_pipeline - INFO - ==================================================
2025-12-08 16:37:13,414 - vectorizer - INFO - [Vectorizer] Using device: cpu
2025-12-08 16:37:17,482 - data_transformation - WARNING - [DataTransformation] Vectorization API not available: HTTPConnectionPool(host='localhost', port=8001): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000001BBC6AAD400>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))
2025-12-08 16:37:17,482 - data_transformation - INFO - [DataTransformation] Using local vectorization (no LLM insights)
2025-12-08 16:37:17,482 - data_transformation - INFO - [DataTransformation] Initialized
2025-12-08 16:37:17,483 - data_transformation - INFO -   Models cache: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\models_cache
2025-12-08 16:37:17,483 - data_transformation - INFO -   Vectorization API: disabled (using local)
2025-12-08 16:37:17,483 - data_transformation - INFO - [DataTransformation] Starting transformation: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_validation\validated_data_20251208_163713.parquet
2025-12-08 16:37:17,496 - data_transformation - INFO - [DataTransformation] Loaded 197 records
2025-12-08 16:37:17,497 - data_transformation - INFO - [DataTransformation] Detecting languages...
2025-12-08 16:37:17,528 - data_transformation - INFO - [DataTransformation] Language distribution:
2025-12-08 16:37:17,529 - data_transformation - INFO -   english: 188 (95.4%)
2025-12-08 16:37:17,529 - data_transformation - INFO -   sinhala: 4 (2.0%)
2025-12-08 16:37:17,529 - data_transformation - INFO -   tamil: 3 (1.5%)
2025-12-08 16:37:17,529 - data_transformation - INFO -   unknown: 2 (1.0%)
2025-12-08 16:37:17,529 - data_transformation - INFO - [DataTransformation] Extracting temporal features...
2025-12-08 16:37:17,555 - data_transformation - INFO - [DataTransformation] Extracting engagement features...
2025-12-08 16:37:17,563 - data_transformation - INFO - [DataTransformation] Extracting text features...
2025-12-08 16:37:17,568 - data_transformation - INFO - [DataTransformation] Vectorizing texts with BERT models...
2025-12-08 16:37:17,570 - vectorizer - INFO - [Vectorizer] Loading model: distilbert-base-uncased
2025-12-08 16:37:50,931 - vectorizer - INFO - [Vectorizer] Loading model: keshan/SinhalaBERTo
2025-12-08 16:38:44,502 - vectorizer - INFO - [Vectorizer] Loading model: l3cube-pune/tamil-bert
2025-12-08 16:38:59,868 - data_transformation - INFO - [DataTransformation] Building feature matrix...
2025-12-08 16:38:59,875 - data_transformation - INFO - [DataTransformation] Feature matrix shape: (197, 776)
2025-12-08 16:38:59,907 - training_pipeline - INFO - ==================================================
2025-12-08 16:38:59,907 - training_pipeline - INFO - [TrainingPipeline] STEP 4: Model Training
2025-12-08 16:38:59,907 - training_pipeline - INFO - ==================================================
2025-12-08 16:39:02,136 - model_trainer - WARNING - [ModelTrainer] MLflow setup error: API request to endpoint /api/2.0/mlflow/experiments/create failed with error code 403 != 200. Response body: ''
2025-12-08 16:39:02,137 - model_trainer - INFO - [ModelTrainer] Initialized
2025-12-08 16:39:02,137 - model_trainer - INFO -   Models to train: ['dbscan', 'kmeans', 'hdbscan', 'isolation_forest', 'lof']
2025-12-08 16:39:02,137 - model_trainer - INFO -   Optuna trials: 50
2025-12-08 16:39:02,137 - model_trainer - INFO - [ModelTrainer] Starting training: C:\Users\LENOVO\Desktop\ModelX-Ultimate\models\anomaly-detection\artifacts\data_transformation\features_20251208_163859.npy
2025-12-08 16:39:02,139 - model_trainer - INFO - [ModelTrainer] Loaded features: (197, 776)
2025-12-08 16:39:03,362 - model_trainer - WARNING - [ModelTrainer] MLflow run start error: API request to endpoint /api/2.0/mlflow/runs/create failed with error code 403 != 200. Response body: ''
2025-12-08 16:39:03,363 - model_trainer - INFO - [ModelTrainer] Training dbscan...
2025-12-08 16:39:03,363 - model_trainer - WARNING - [ModelTrainer] Optuna not available, using defaults
2025-12-08 16:39:07,594 - model_trainer - INFO - [ModelTrainer] Training kmeans...
2025-12-08 16:39:07,595 - model_trainer - WARNING - [ModelTrainer] Optuna not available, using defaults
2025-12-08 16:39:08,242 - model_trainer - INFO - [ModelTrainer] Training hdbscan...
2025-12-08 16:39:08,242 - model_trainer - WARNING - [ModelTrainer] Optuna not available, using defaults
2025-12-08 16:39:08,242 - model_trainer - WARNING - [ModelTrainer] hdbscan error: hdbscan not available
2025-12-08 16:39:08,242 - model_trainer - INFO - [ModelTrainer] Training isolation_forest...
2025-12-08 16:39:08,242 - model_trainer - WARNING - [ModelTrainer] Optuna not available, using defaults
2025-12-08 16:39:08,978 - model_trainer - INFO - [ModelTrainer] Training lof...
2025-12-08 16:39:08,978 - model_trainer - WARNING - [ModelTrainer] Optuna not available, using defaults
2025-12-08 16:39:09,393 - model_trainer - INFO - [ModelTrainer] Best model: kmeans
2025-12-08 16:39:09,393 - training_pipeline - INFO - ============================================================
2025-12-08 16:39:09,393 - training_pipeline - INFO - [TrainingPipeline] PIPELINE SUCCESS
2025-12-08 16:39:09,394 - training_pipeline - INFO - [TrainingPipeline] Duration: 118.1s
2025-12-08 16:39:09,394 - training_pipeline - INFO - ============================================================
2025-12-08 16:39:09,394 - main - INFO - 
============================================================
2025-12-08 16:39:09,394 - main - INFO - PIPELINE RESULTS
2025-12-08 16:39:09,394 - main - INFO - ============================================================
2025-12-08 16:39:09,394 - main - INFO - Status: SUCCESS
2025-12-08 16:39:09,394 - main - INFO - Run ID: 20251208_163711
2025-12-08 16:39:09,394 - main - INFO - Duration: 2025-12-08T16:37:11.260871 to 2025-12-08T16:39:09.393783
2025-12-08 16:39:09,394 - main - INFO - 
--- Data Ingestion ---
2025-12-08 16:39:09,394 - main - INFO - Total records: 197
2025-12-08 16:39:09,394 - main - INFO - From SQLite: 0
2025-12-08 16:39:09,394 - main - INFO - From CSV: 2718
2025-12-08 16:39:09,394 - main - INFO - 
--- Data Validation ---
2025-12-08 16:39:09,394 - main - INFO - Valid records: 197
2025-12-08 16:39:09,394 - main - INFO - Validation status: True
2025-12-08 16:39:09,394 - main - INFO - 
--- Data Transformation ---
2025-12-08 16:39:09,395 - main - INFO - Language distribution: {'english': 188, 'sinhala': 4, 'tamil': 3, 'unknown': 2}
2025-12-08 16:39:09,395 - main - INFO - 
--- Model Training ---
2025-12-08 16:39:09,395 - main - INFO - Best model: kmeans
2025-12-08 16:39:09,395 - main - INFO - Best metrics: {'silhouette_score': 0.1279573771753121, 'calinski_harabasz_score': 32.005100245233244, 'davies_bouldin_score': 1.8452428255113005, 'n_clusters': 5, 'n_samples': 197, 'n_noise_points': 0, 'noise_ratio': 0.0, 'min_cluster_size': 4, 'max_cluster_size': 74, 'mean_cluster_size': 39.4}
2025-12-08 16:39:09,395 - main - INFO - MLflow run: 
2025-12-08 16:39:09,395 - main - INFO - Anomalies detected: 20
2025-12-08 16:39:09,395 - main - INFO - 
============================================================
2025-12-08 16:39:09,395 - main - INFO - PIPELINE COMPLETE
2025-12-08 16:39:09,395 - main - INFO - ============================================================
